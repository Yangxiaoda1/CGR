import numpy as np
def normalize_vector(vec):
    norm = np.linalg.norm(vec)
    return vec / norm

def cosine_similarity(vec1, vec2):
    # 将字符串形式的嵌入向量转换为numpy数组
    vec1 = np.array(eval(vec1)).flatten()
    vec2 = np.array(eval(vec2)).flatten()
    
    # 对向量进行归一化
    vec1 = normalize_vector(vec1)
    vec2 = normalize_vector(vec2)
    
    # 计算归一化后的余弦相似度
    dot_product = np.dot(vec1, vec2)
    
    similarity = dot_product  # 由于向量已经归一化，分母为1
    return similarity
# 读取txt文件内容
file_path = '/mnt/disk2/yangxiaoda/CGR/data/styledb/part2.txt'  # 替换成你的txt文件路径
# vector_template = "[[-1.0601e-02,  8.7253e-03,  2.7258e-02, -9.3346e-03,  2.2305e-03,-8.9276e-03, -4.5270e-02,  1.6658e-02, -3.5122e-02, -4.3618e-02,-4.7329e-02, -2.4065e-02, -2.8935e-02, -3.5702e-02, -7.4878e-03,1.4597e-02,  4.6315e-02, -1.8474e-02,  1.3982e-02,  4.4213e-02,4.1030e-03,  2.4100e-02,  1.2601e-02,  4.3642e-02,  4.6379e-02,2.6881e-03, -4.8788e-03, -4.9440e-02, -2.2244e-02,  1.5233e-02,-6.4348e-03,  5.8733e-02,  4.4914e-02, -1.4409e-02, -2.8409e-02,-4.8662e-02, -5.3636e-03,  1.8818e-02,  1.8533e-02,  2.6904e-02,-4.6959e-02,  3.6779e-02,  1.8301e-02,  5.3149e-03, -3.3175e-02,2.5993e-02,  4.0376e-02, -5.6872e-02,  7.6177e-03,  1.6681e-03,2.2688e-02, -6.7911e-03, -3.4059e-02, -4.8344e-02,  3.8847e-03,5.8522e-02, -3.6887e-02,  2.6892e-02, -2.5462e-02,  4.5301e-02,-4.0468e-02,  6.3195e-03, -2.9665e-02,  7.9731e-02,  1.6913e-02,-3.4588e-04,  4.1723e-02,  5.3745e-02,  9.4789e-03, -2.0403e-02,8.4459e-03,  2.7085e-02, -8.8958e-03, -3.2113e-03,  1.2420e-02,-4.5692e-02, -3.8390e-02, -5.1378e-03, -1.3594e-02, -5.1114e-02,1.5877e-02, -9.9264e-03, -3.1625e-03,  7.0317e-02, -1.8265e-02,-3.5187e-02, -1.5663e-02, -2.8543e-02, -4.6058e-02, -7.0589e-02,5.7230e-02, -5.7578e-02, -1.5341e-02,  7.3465e-02, -2.9323e-02,-6.8917e-02, -5.6963e-02, -2.8881e-02,  2.2235e-02,  1.1979e-02,-3.1489e-02, -2.3060e-02, -1.7542e-02, -2.1423e-02, -2.8284e-02,5.0669e-02, -2.9045e-03,  2.1203e-02, -6.6492e-03,  5.5475e-02,7.0632e-02,  6.2301e-02, -5.4207e-03, -1.1882e-02, -4.2475e-03,-1.2286e-02, -6.0359e-02, -4.2285e-02,  1.0968e-01,  5.7380e-02,1.1572e-02, -1.8643e-02,  8.7538e-02, -1.2136e-02, -5.9601e-02,-1.6241e-02,  3.8537e-02, -1.1528e-02,  2.7327e-02,  3.8333e-03,2.7441e-02,  5.7965e-02,  1.7536e-02, -4.4325e-02, -2.4415e-02,4.7988e-02, -1.2212e-03, -8.0091e-03, -4.8843e-02, -8.2776e-03,-1.2094e-02, -2.5091e-03,  5.7123e-02, -3.1907e-02, -3.6484e-02,-3.9310e-02,  4.6257e-02, -4.5539e-02, -7.0182e-02, -5.1103e-02,-2.5838e-02,  3.1773e-02,  2.9565e-02, -9.0784e-03,  3.1481e-02,2.2803e-03,  6.2875e-02, -5.3299e-03,  6.8765e-03,  2.3378e-02,2.8437e-02,  5.3984e-02,  3.9596e-02, -9.2905e-03,  1.2318e-02,-8.4449e-03,  4.2955e-02, -4.1425e-02, -2.1432e-03, -1.5527e-02,6.2151e-02,  1.5391e-02, -4.9855e-02,  1.3264e-02, -9.8777e-03,-4.5228e-02, -1.0759e-02, -7.6334e-02,  4.3149e-02,  2.6253e-02,-4.9527e-02, -1.9899e-02, -6.1386e-02,  3.3355e-02, -5.7062e-02,4.9590e-02,  2.3183e-02,  6.4371e-02,  2.8656e-02,  6.5907e-02,-4.8593e-03,  2.5140e-02, -1.6839e-03,  3.1897e-02,  2.5904e-02,-4.4016e-02, -2.2029e-02,  7.2656e-02, -1.0874e-03, -2.2206e-02,1.1467e-02,  4.3624e-02,  2.8599e-02,  1.7231e-02, -3.0771e-03,-3.6279e-02,  1.1902e-02, -6.1816e-02,  1.9720e-02,  3.1678e-02,-2.9445e-02, -2.0040e-02, -5.3752e-02,  3.2817e-03,  5.1858e-02,-3.6501e-02, -2.3181e-03,  6.5177e-02, -3.8255e-02,  8.1855e-02,2.6391e-02,  2.9819e-02,  2.8889e-02,  7.2199e-03, -8.2159e-03,-7.2486e-02, -1.2779e-02, -3.4855e-02,  6.2193e-03,  2.0591e-03,3.3934e-02, -2.4962e-02,  5.3030e-02, -1.1268e-01,  5.3708e-02,-3.5611e-02,  6.8805e-03,  3.9177e-02,  6.2864e-02, -2.5630e-02,2.9149e-02,  4.7650e-02, -9.2995e-03, -3.1211e-02, -3.7759e-03,2.4651e-02, -1.0306e-02, -3.7395e-04,  1.6635e-03,  5.3604e-02,5.0992e-02, -1.7092e-03,  4.2846e-04, -7.7908e-02, -2.3562e-02,2.7944e-02,  2.0754e-02,  1.5113e-02, -1.3594e-02, -5.5394e-02,2.3966e-03, -7.8226e-03, -4.9409e-02, -8.5542e-03, -1.1814e-02,7.2290e-02,  1.9715e-02, -8.7078e-02,  2.1719e-02,  2.3796e-02,2.5969e-02, -8.3994e-03, -1.7154e-02, -3.4298e-02, -2.7520e-02,-2.8343e-02, -1.4233e-02,  1.2707e-02,  1.5546e-02, -1.2937e-02,1.2338e-02,  4.3177e-02, -1.3634e-02,  2.5451e-02, -2.2310e-02,-1.6871e-02, -5.4011e-03, -2.9674e-02, -1.9970e-02, -2.5003e-02,-1.2706e-02, -1.9936e-02, -1.8287e-03,  5.5797e-02, -8.4945e-03,3.9441e-02,  4.4309e-02, -2.8177e-02, -5.9299e-02,  8.9854e-02,2.1548e-02,  4.2832e-04, -3.3210e-02,  3.0518e-02, -1.6211e-02,3.8751e-02, -4.1907e-02, -1.9422e-02,  4.0852e-02, -4.0498e-02,-5.8313e-02, -4.6690e-02,  5.7798e-03, -3.9717e-02,  2.3062e-02,3.5738e-02,  1.8935e-02,  1.3872e-02,  2.4506e-02, -2.6227e-02,6.5959e-03,  3.5217e-02, -5.4374e-03,  6.2432e-03, -1.3466e-02,1.3496e-02, -6.4520e-02, -1.6375e-02, -5.2396e-04, -1.2000e-01,-3.0340e-02, -5.4955e-02,  1.3433e-02, -1.0118e-02, -1.4082e-02,1.2699e-02,  5.1635e-03, -9.7000e-04, -2.6405e-02,  5.0431e-02,-3.1304e-02, -2.6297e-02, -1.3576e-02,  6.8571e-02, -6.4361e-02,1.4240e-04,  3.1484e-02,  5.4247e-03,  7.2885e-03,  1.3397e-02,4.2382e-02,  1.2268e-02, -3.8573e-02,  1.8743e-02,  2.1786e-02,-3.0481e-02, -1.6760e-02,  1.7162e-02, -7.1436e-03, -7.2588e-03,1.7890e-03, -3.4674e-02, -4.2638e-03, -4.8623e-02,  2.6655e-02,7.5719e-02,  1.2273e-03, -1.2566e-02, -7.9810e-02, -4.9211e-02,-8.6539e-03, -3.5626e-03,  1.6641e-02, -3.1534e-02,  9.0598e-02,-3.3080e-02,  1.6929e-02,  7.4105e-02, -8.4397e-03,  1.8892e-03,4.9360e-02, -2.9930e-05, -1.7647e-02,  2.3435e-02,  1.2136e-02,1.5942e-03,  7.1900e-03,  7.0464e-03, -2.6025e-02, -5.7160e-03,-6.8816e-02,  2.0930e-02,  2.8811e-02, -2.0993e-02,  9.3763e-03,1.4713e-02,  1.0303e-02,  2.1915e-02, -2.2500e-02, -3.7430e-02,3.3830e-03,  9.6843e-03,  3.6880e-03,  2.7470e-02,  4.2990e-02,3.3479e-02, -2.6846e-02,  1.6966e-02, -4.1298e-02, -1.8855e-02,-2.0446e-02,  5.2229e-02, -1.9258e-02, -4.8624e-02,  4.5452e-02,5.2257e-02, -1.3801e-02, -7.2881e-03, -1.5811e-02,  4.5795e-02,-3.6747e-03,  2.2625e-02, -6.9221e-02, -2.8947e-02, -3.9763e-02,-8.2892e-02, -2.2022e-03,  8.8823e-02,  1.5853e-02,  2.9266e-02,3.1424e-02, -2.6520e-02,  2.3719e-02, -3.3265e-02,  1.4804e-02,5.1839e-02,  3.3962e-03, -4.1815e-02,  1.3655e-02, -6.9676e-02,-1.3678e-02,  1.0839e-02, -3.0126e-02,  5.6578e-02, -5.8895e-02,-4.6944e-02,  3.9272e-02,  2.3818e-02,  4.0422e-03,  3.8523e-03,1.1066e-02,  2.3715e-02,  6.9744e-02,  6.3041e-02, -7.2737e-02,-3.7130e-04, -4.4702e-02,  1.5747e-02,  1.0069e-01, -3.7229e-02,3.4933e-02,  5.0048e-02,  1.1255e-02,  8.1101e-02, -4.2406e-02,-5.5354e-03, -1.5803e-02,  5.2099e-02,  2.9054e-02, -1.1997e-02,-1.7321e-02,  3.9318e-02,  1.5034e-03,  8.4013e-03,  2.1835e-02,2.9097e-02,  1.6385e-02,  3.0638e-02,  6.9063e-02, -1.5959e-02,-5.6654e-02, -1.1052e-02,  1.8594e-02, -4.2571e-02,  1.0877e-02,1.1704e-02, -2.5066e-02,  6.0717e-03, -3.8375e-02,  4.5992e-02,9.5666e-02,  6.1964e-02,  5.7424e-02, -1.3718e-02, -3.3643e-02,3.0499e-03, -6.0783e-03, -4.6864e-02, -1.4374e-02, -1.1397e-02,-5.4817e-02, -4.4350e-02, -4.3753e-03,  2.4033e-02, -2.1111e-02,-3.5198e-02,  1.8103e-02, -2.4291e-02, -4.5176e-02,  1.0858e-03,1.6844e-02,  5.2997e-02, -5.4534e-03, -7.1174e-02, -1.3246e-02,1.8704e-02,  2.1861e-02,  3.4157e-03, -1.9121e-02, -5.0851e-02,3.6085e-02, -1.9277e-02,  6.5866e-02, -3.9897e-02,  3.9302e-02,3.3355e-02,  1.1968e-03, -3.9469e-02, -4.5435e-02,  1.4243e-02,1.0463e-02, -2.9369e-02,  8.7530e-03,  4.5448e-02,  4.5917e-02,4.5111e-02, -4.5076e-02, -1.2360e-03, -7.9205e-04, -6.1666e-03,1.3625e-02,  2.1758e-02, -3.4949e-02, -4.5224e-03, -4.0730e-03,-1.7343e-02, -5.2227e-02, -2.1824e-02, -2.4527e-03, -2.3456e-02,5.0637e-02, -2.3829e-03,  6.5947e-03, -5.7743e-03,  3.2104e-02,-2.5115e-02, -4.0228e-02, -5.3598e-02,  2.9658e-02,  4.1162e-02,-5.3994e-02,  4.8610e-02,  2.6603e-02, -3.2920e-03, -7.5386e-02,5.4102e-02,  2.2116e-02,  5.5910e-02, -4.0837e-02,  5.4233e-02,-1.1004e-02, -7.6583e-02,  2.0441e-02, -2.0769e-02,  1.5578e-02,3.5341e-02, -1.2948e-03, -2.1112e-02,  5.1131e-02,  2.0139e-02,-8.4708e-02, -2.4048e-04, -2.5059e-02,  5.5974e-04, -5.1777e-02,2.6042e-02,  9.1632e-03, -7.5597e-02,  4.3617e-02,  4.2387e-03,-2.2028e-03,  2.0858e-02, -4.0870e-02,  1.8072e-02, -3.1214e-02,-5.0088e-02, -4.8419e-05, -7.8296e-03, -9.1139e-03, -5.7284e-03,-2.4786e-02, -3.6382e-02, -1.5961e-02,  1.6998e-02, -4.0735e-02,2.4004e-02, -3.7399e-04,  2.4888e-02,  7.9598e-03, -2.0077e-02,-1.2308e-02,  1.3291e-02, -4.0857e-02, -4.0035e-02,  4.1761e-02,4.1276e-02,  3.9678e-02,  6.1193e-02,  1.1389e-02, -4.7028e-03,-2.2593e-02, -4.6375e-02, -5.2717e-02,  3.9045e-02,  2.1350e-02,3.3344e-02,  2.1461e-02,  6.3654e-03,  2.0638e-03,  4.5222e-02,2.2355e-02, -7.8718e-02,  9.1620e-04,  3.8734e-02,  3.3301e-02,7.7501e-02, -1.1933e-02,  3.3308e-03, -6.0107e-02, -1.5237e-02,1.8934e-02,  5.9899e-03, -2.8133e-02,  6.1897e-02,  5.3586e-02,2.7768e-02,  6.1208e-02, -9.2855e-03,  2.9239e-03,  1.0145e-02,1.3464e-02, -8.0178e-03, -2.7537e-02,  2.2609e-02, -3.2495e-02,-1.1041e-02,  1.1923e-02,  3.1737e-02,  3.0015e-02, -2.2920e-02,2.4816e-02, -1.8608e-02,  3.3638e-02,  9.1103e-03, -7.2335e-02,2.4845e-02, -7.7819e-02, -4.1490e-02,  2.9344e-03, -2.1159e-02,-1.1535e-02,  4.2681e-02, -2.4103e-02,  1.4374e-02,  1.2426e-02,1.9791e-02, -5.5343e-02,  9.6531e-03, -9.6361e-03, -1.1383e-03,-3.8475e-02, -1.5800e-02, -1.0032e-01, -5.2307e-03,  8.1938e-02,-2.1145e-02,  2.9173e-02, -2.4805e-02,  4.7079e-02,  5.2459e-02,1.2551e-02, -6.2033e-02,  1.9277e-02,  2.5666e-03,  9.7736e-03,-3.2851e-02, -1.4647e-03,  1.0466e-02, -1.3593e-02,  2.5352e-02,1.1808e-02,  2.3445e-02,  1.6785e-02, -3.3849e-02, -4.3490e-02,-2.2605e-02,  3.2117e-03,  4.5300e-02, -2.5783e-03,  8.3989e-02,-2.2725e-03,  3.3996e-02,  9.2532e-02,  5.1298e-03, -4.1233e-02,-9.3285e-03,  6.1227e-03, -2.6322e-03,  3.4323e-02,  1.0709e-02,-1.5860e-02,  8.7936e-02,  9.7045e-03, -7.3524e-02,  8.0004e-02,-1.7161e-03, -1.3361e-02,  3.5116e-02,  2.8684e-02, -1.8888e-02,-1.1212e-02, -1.9462e-02, -2.5406e-02,  9.1693e-03,  3.8279e-02,2.6894e-02,  1.0027e-02,  4.2560e-02,  1.6543e-02, -4.4983e-03,4.2713e-02,  2.3517e-02, -1.9576e-02,  1.6335e-03, -2.1212e-02,7.5433e-03,  4.5642e-02, -1.2143e-03, -4.2123e-03, -1.1046e-02,2.0483e-02,  1.3570e-02, -1.2709e-02, -4.2051e-03,  5.1747e-02,-1.5605e-03, -6.6765e-03, -1.6249e-02,  9.5248e-03, -7.4402e-03,-1.2825e-02, -3.7845e-02,  1.0288e-01,  3.3617e-02, -2.5064e-02,4.3862e-03, -2.7215e-02, -4.2348e-02]]"
vector_template = "[[ 6.5421e-02,  3.0325e-02, -6.0703e-02, -4.0342e-02,  3.7782e-02,-6.4193e-02, -1.8258e-02,  2.9501e-02, -5.3292e-02,  3.8697e-02,1.8862e-02,  1.7849e-02, -2.1099e-02, -3.4564e-02, -2.5723e-02,4.2648e-03, -2.1825e-03,  3.0320e-02, -3.3610e-02, -1.4235e-02,4.0624e-02,  2.3788e-02, -2.3549e-02,  1.6918e-02,  3.7565e-04,1.4707e-02,  2.1924e-02,  4.4694e-02, -1.2483e-03, -5.3535e-03,4.0139e-02,  3.5390e-03,  1.5683e-02,  5.7475e-02, -2.2321e-02,-2.1469e-02, -1.2200e-02, -3.5060e-02,  1.7700e-02,  2.2018e-02,-2.2134e-02, -2.8308e-02,  9.9204e-03, -3.8344e-02,  7.4750e-02,-2.2164e-02, -8.2194e-04,  2.7600e-02,  4.3470e-03, -2.8129e-02,2.4082e-02,  3.5918e-03,  5.0787e-02,  3.1836e-02, -2.0548e-02,-1.7545e-02, -5.0200e-03,  9.5322e-03,  4.5698e-03, -5.4006e-02,4.8081e-02,  2.4968e-02,  6.2838e-02, -4.4632e-02, -1.0840e-02,7.7651e-03, -5.3718e-02,  4.3081e-02, -2.3076e-03,  6.4763e-02,1.0896e-02,  2.4453e-02,  4.1887e-02, -1.2952e-02,  2.7275e-02,-7.2940e-05,  2.3354e-02, -1.3874e-03,  2.7455e-02, -3.2195e-02,-2.6192e-02, -4.9999e-02,  4.0937e-02, -4.3648e-02, -6.8048e-03,3.3359e-02, -8.1433e-03, -5.7592e-02, -6.0216e-02,  3.1849e-02,2.4341e-02,  2.5115e-02,  1.1527e-02, -2.7876e-02, -6.6588e-02,1.7774e-02,  1.2969e-02,  4.3193e-03,  2.5551e-02, -4.4459e-02,-2.0558e-02, -4.3804e-02,  3.5890e-02,  5.0358e-02, -1.4416e-02,-7.9895e-02, -2.6846e-02, -2.4000e-02, -2.8729e-04,  3.9937e-02,5.5897e-02, -1.4742e-02, -3.6740e-02,  3.0821e-02,  7.0332e-03,-1.6887e-02, -4.1727e-02, -4.1963e-02, -9.3237e-03, -8.0392e-02,-1.0197e-02,  1.3918e-02, -5.4047e-03,  2.8359e-02,  2.1338e-02,3.7972e-02,  1.5200e-02, -1.6318e-02, -6.2000e-02, -7.0465e-02,1.7299e-02, -1.0303e-01, -5.9430e-02, -1.5657e-02, -6.4326e-02,2.0964e-02, -1.0855e-02, -5.8813e-02, -1.2974e-02, -7.6468e-02,-4.4712e-02, -1.2552e-02, -2.1029e-02, -5.0794e-02,  3.2846e-02,-1.6704e-02, -8.0025e-02, -4.2257e-02,  3.4016e-03,  2.0726e-03,-2.0146e-02,  4.5868e-02,  1.7769e-02, -6.6631e-03, -4.1521e-03,-8.9300e-02,  1.8323e-02,  1.1153e-01, -1.1832e-02,  3.3007e-03,-1.4078e-02, -6.8721e-03, -7.9703e-03, -7.5258e-02, -1.2236e-02,3.4642e-02, -1.4192e-02,  1.0958e-02,  2.4693e-02, -6.3497e-02,-4.3404e-02, -3.4727e-02,  8.5889e-02, -2.9360e-02, -3.1875e-03,-2.0901e-02,  3.1245e-02,  2.9414e-02, -9.8121e-04,  3.6310e-02,4.9659e-02, -6.0268e-02, -4.1978e-02,  2.5094e-02,  5.1158e-02,-2.7172e-02, -8.3329e-04, -2.7092e-03,  3.7074e-02,  1.3018e-02,-1.9921e-02, -4.6427e-02, -7.4431e-02,  3.2416e-02, -2.2203e-02,-2.9783e-02, -3.8816e-02, -2.0001e-02, -9.9926e-03, -4.3556e-02,-1.3728e-02, -7.1270e-03,  1.5771e-02, -3.4555e-02, -6.3033e-02,1.7584e-02, -4.4278e-02,  1.7973e-02, -6.4914e-04,  3.1513e-02,-1.1303e-03,  5.1312e-03,  3.9540e-02,  2.9593e-02,  2.6926e-02,-5.4656e-02, -1.3626e-02,  5.5211e-02,  5.1227e-02, -5.2095e-02,-4.5661e-03, -3.0659e-02, -2.7498e-02, -3.5201e-02,  1.4213e-02,-3.0383e-03,  3.2640e-02,  7.4801e-02, -1.9078e-02,  3.7094e-03,1.4472e-02,  2.2029e-02,  3.1262e-02,  9.0367e-02,  5.7659e-03,2.5706e-02, -5.9357e-02,  3.5371e-02,  2.6018e-02, -2.2181e-02,7.4008e-02, -2.6738e-02, -6.6348e-02, -1.7155e-02, -7.5332e-03,-8.8487e-03,  3.8877e-02,  6.3063e-05, -3.0683e-02, -1.0668e-03,6.5436e-02,  9.0481e-02,  5.9130e-02, -2.6276e-02, -6.5054e-02,-3.9038e-03, -2.7000e-02, -7.8257e-02,  3.3740e-02,  1.6252e-02,-3.5052e-02,  1.4725e-04, -1.0013e-03,  3.0067e-02,  2.7041e-02,1.3597e-02,  5.6331e-02,  1.1654e-02,  4.8029e-03, -5.4057e-02,-3.4443e-02,  1.8436e-02, -4.4629e-02, -1.9699e-02, -5.4858e-02,-1.8603e-02, -4.8327e-03,  4.0296e-02, -9.4925e-03,  2.3600e-02,1.7293e-02, -2.6147e-02,  9.9785e-03,  3.9131e-03,  4.7563e-02,6.6837e-02,  2.8117e-03,  6.5333e-03, -1.1900e-02, -2.9676e-02,-2.6294e-02, -3.2801e-03,  2.9900e-03, -6.9308e-03, -5.1284e-03,2.8315e-02, -4.3060e-02, -2.9105e-02, -8.5768e-03, -3.2901e-02,6.1953e-03, -2.9588e-03, -1.5472e-02,  4.8633e-02,  1.6416e-02,-2.0172e-02,  3.5473e-02, -2.2059e-02,  1.1732e-03, -2.4847e-02,-2.3426e-02, -3.6020e-02,  2.0814e-02,  5.3244e-02,  8.9468e-03,-5.3816e-03, -1.9880e-02,  3.4101e-04, -6.2639e-02,  6.0202e-03,6.2606e-03, -1.1963e-03, -9.3423e-03, -2.3848e-03,  3.8607e-02,-2.3831e-02,  1.2110e-02, -1.4096e-02,  3.3581e-02,  3.4817e-03,4.1095e-02, -2.8273e-02, -3.0051e-02,  3.1601e-02, -4.1583e-02,4.6343e-02, -3.3466e-03,  6.4844e-03, -1.9708e-02, -9.7874e-03,3.6974e-03,  4.2898e-02,  2.1430e-02, -3.4405e-02, -5.0043e-02,-1.2085e-02, -7.1640e-03, -8.1674e-02, -2.5695e-02,  1.3663e-02,1.2284e-02, -1.4033e-02, -9.2115e-03, -2.4378e-02,  5.8943e-03,-4.3333e-02,  3.6836e-03, -3.7515e-02,  1.4561e-02,  3.9459e-03,-4.9608e-02, -5.2725e-02, -7.5357e-02,  2.6866e-02, -8.4441e-03,-1.2976e-02,  2.9443e-02,  4.3951e-02,  4.3765e-02,  4.2791e-02,2.6379e-02,  1.8641e-02,  3.5881e-02,  1.8112e-02,  5.2509e-03,1.0095e-02, -5.6711e-02,  3.1055e-02, -1.7808e-02,  3.7455e-02,6.2993e-02,  1.8534e-04, -1.2092e-03, -3.0590e-02,  6.6824e-03,1.2808e-02,  4.3904e-02, -3.2192e-02,  1.9342e-02, -8.2189e-04,-4.4203e-02,  3.6421e-02, -1.4098e-03,  2.6166e-02,  2.9184e-02,2.1556e-02,  5.4827e-03,  6.9910e-02,  3.2133e-03, -3.6624e-02,3.6008e-03, -1.2744e-02,  3.5534e-02,  4.4682e-04, -4.2956e-02,-3.9515e-02, -1.3483e-03, -1.7829e-03, -1.2803e-02, -3.6347e-02,3.7941e-03,  4.4554e-02, -4.6727e-02, -1.1851e-01, -4.7669e-02,3.5084e-02,  2.9339e-02,  7.6127e-02,  2.3899e-03, -3.4522e-02,3.3797e-02, -2.9539e-02,  4.1979e-02,  4.3687e-02, -3.1117e-02,-1.6123e-02,  2.0392e-02,  4.3696e-02, -2.6672e-02,  3.7038e-02,-7.2413e-03, -2.5872e-03, -2.4715e-02,  1.1867e-02, -1.5360e-02,-5.2790e-02,  4.7609e-02, -4.4323e-02,  1.3184e-02, -2.5627e-02,2.2625e-02,  8.2325e-03,  1.7646e-02, -6.4661e-03, -2.7063e-02,4.4575e-02,  1.1705e-02, -3.0138e-03,  8.8281e-04, -1.9163e-03,3.0350e-02, -2.6370e-02, -4.8878e-04,  2.3289e-02,  2.7821e-02,1.4545e-02,  1.1720e-02,  3.0620e-02, -3.1634e-02,  1.6432e-04,2.8801e-02,  4.7746e-02, -3.9106e-02,  5.5184e-02,  3.9778e-02,-2.4734e-03,  4.5653e-02,  1.4734e-01, -1.8549e-02,  1.7976e-02,3.3160e-02,  1.3206e-02, -5.5374e-02,  2.3071e-02, -1.3345e-02,1.7378e-02,  3.1346e-02, -2.8088e-02,  1.0922e-02,  1.9166e-02,-3.3518e-02,  1.1778e-02, -4.2152e-02, -1.3423e-02,  1.9305e-02,-1.5828e-02,  4.0557e-02, -4.0304e-02, -6.9012e-03, -9.8681e-03,1.4314e-02, -2.1918e-02, -1.9406e-02, -6.8754e-03, -8.2547e-03,2.1318e-03, -3.0233e-03, -5.7449e-02,  2.0468e-02, -9.4504e-02,-3.3298e-03,  1.6797e-02, -8.2699e-02, -4.9202e-02,  2.2363e-02,2.9244e-02, -5.8635e-02,  1.5083e-02,  8.9091e-03, -2.5920e-02,-7.8120e-03,  3.2401e-02, -4.0207e-03,  3.0794e-02, -3.8276e-02,6.1778e-04,  5.9807e-02, -3.4687e-02,  2.0723e-02,  3.3168e-02,-3.0395e-03,  8.5376e-03,  2.1291e-02,  3.7009e-02,  1.0711e-02,5.9842e-03,  1.1093e-02, -1.4701e-02, -6.9040e-02,  2.7988e-02,2.5372e-02, -2.2048e-02, -9.0631e-03,  4.8211e-02,  3.6469e-03,2.0351e-02,  3.0132e-02, -5.2907e-03, -4.5553e-03, -6.9690e-04,-4.4924e-03,  5.0962e-03, -3.5441e-02,  9.9166e-03, -3.5649e-02,2.1477e-02, -5.0192e-04, -7.1529e-04, -1.4979e-02,  5.7863e-03,2.8979e-02, -8.5105e-02, -4.4385e-02, -2.3167e-03,  3.4414e-02,1.3375e-02, -1.2658e-01, -6.2094e-02,  1.1986e-02, -1.5070e-02,4.8703e-02,  6.4767e-02, -1.1959e-03,  6.5591e-02, -1.7942e-01,3.1875e-02, -2.5295e-02,  3.6776e-02, -2.2913e-02,  1.8612e-02,-1.6936e-02,  6.1417e-02,  2.4709e-02, -4.7948e-02,  4.2801e-02,-3.0684e-02, -1.4024e-03,  2.8377e-02,  4.4740e-02,  5.4518e-02,1.8340e-02, -2.0983e-02, -1.1664e-02, -2.6207e-02,  6.6019e-02,5.6295e-02, -2.0131e-02,  2.5109e-02,  2.6881e-02, -3.8203e-02,-7.0268e-02,  5.7656e-04, -9.1824e-03,  3.0101e-03, -2.4196e-02,-5.1128e-02, -2.7589e-02,  2.6883e-03,  4.8769e-03,  1.1827e-02,-1.9827e-02, -4.7586e-03, -1.4377e-02,  6.7068e-02,  1.2958e-02,2.7599e-02,  1.2730e-02,  4.0456e-02, -6.6791e-04,  3.5633e-02,-4.2638e-02, -2.3463e-02, -2.8444e-03, -2.5589e-02, -6.2298e-03,-6.3686e-03,  5.4293e-02, -3.6285e-03, -5.0003e-02, -4.5092e-02,-6.3760e-03, -9.3483e-03,  5.4994e-03, -8.1323e-03,  2.2794e-02,3.6032e-02,  2.4345e-02,  7.9162e-03,  1.5415e-02, -1.4498e-02,-5.7837e-02,  2.1792e-02,  4.4910e-02,  2.9713e-03, -3.8444e-02,-8.3238e-02,  1.2886e-03, -4.3490e-03,  6.0259e-02, -4.1942e-03,-4.5105e-02, -3.1085e-03, -2.8010e-02, -2.7668e-02,  1.2341e-01,5.5208e-02,  7.1856e-03,  4.9321e-03, -6.0197e-02,  2.7219e-02,-1.7596e-03, -1.8651e-02,  7.1597e-02,  3.3609e-02,  1.0877e-02,-3.0801e-03, -7.9803e-03, -5.4964e-02,  3.7401e-02,  4.1851e-02,-1.9784e-02, -1.0554e-02,  2.6070e-02, -8.6591e-03,  3.7561e-02,2.0550e-02,  5.4555e-02, -1.4443e-02,  2.7779e-02, -5.0181e-02,-2.1744e-02,  1.3694e-02, -2.3298e-03, -1.7152e-02, -1.2030e-02,-2.5027e-02,  4.3600e-02, -4.0964e-02, -3.8119e-02,  6.7043e-02,1.7474e-02,  5.5381e-03,  6.9174e-03,  4.9771e-02,  2.6669e-02,9.2328e-03, -2.1995e-02,  3.3991e-02, -4.9688e-02,  1.5781e-02,-1.9468e-02, -4.4470e-03,  2.9111e-03, -8.1054e-04,  3.2815e-02,1.7621e-02,  2.3747e-02,  1.3521e-02,  2.8202e-02, -1.2685e-02,4.5071e-02, -9.3316e-04,  6.1424e-02, -9.7159e-02,  2.9622e-02,-4.6179e-03, -2.6793e-02,  4.8896e-02, -1.2522e-02,  2.1397e-02,-5.5010e-02,  7.5262e-02, -8.6030e-02, -4.2890e-02,  4.3783e-02,-7.9724e-03, -6.1244e-03, -8.0436e-03,  2.1298e-02,  3.4695e-03,-4.7617e-02,  2.3101e-02, -4.9029e-03, -9.7228e-02, -6.3538e-03,4.8704e-02,  1.7038e-03, -8.1586e-02, -4.5713e-02, -6.0855e-03,-7.1423e-02, -3.6027e-02, -1.2677e-02,  1.2400e-02,  8.3898e-03,-2.2083e-02,  1.7969e-02, -1.9455e-02,  1.8775e-02, -1.2655e-02,-1.5879e-02,  8.0508e-04, -3.4364e-02, -2.9811e-02,  2.4344e-02,4.9691e-03, -7.1683e-02,  4.0883e-03, -5.5960e-02,  1.5645e-02,5.8166e-02, -5.2930e-02, -3.6567e-02,  5.4501e-02, -8.0836e-03,-4.8144e-02, -1.1675e-02, -3.0679e-02,  3.3076e-02,  3.3393e-02,-3.1293e-02,  5.3949e-03,  9.6631e-03,  2.2921e-02, -2.2106e-02,-6.0802e-02,  2.9447e-02, -3.7003e-02]]"
with open(file_path, 'r') as f:
    lines = f.readlines()

similarities = []
img_names = []

for line in lines:
    if '.jpg' in line:
        split_index = line.index(':')
        image_name = line[:split_index].strip()  # 分离出图片名部分
        tensor_sequence = line[split_index + 1:].strip()  # 分离出 tensor 序列部分
    elif ' 'in line:
        str = line.strip()
        tensor_sequence += str
        if 'cuda:' in line:
            tensor_sequence = tensor_sequence.replace(", device='cuda:0')", "")
            tensor_sequence = tensor_sequence.replace(",device='cuda:0')", "")
            tensor_sequence = tensor_sequence.replace("tensor(", "")
            # if '23Rococo' in image_name:
            similarity = cosine_similarity(vector_template, tensor_sequence)
            similarities.append(similarity)
            img_names.append(image_name)

# 对相似度进行排序，并获取前五个最大值及其对应的图片名
sorted_indices = sorted(range(len(similarities)), key=lambda k: similarities[k], reverse=True)
top_5_indices = sorted_indices[:10]

for index in top_5_indices:
    print(f"Image Name: {img_names[index]}, 余弦相似度: {similarities[index]}")
            

# # 读取txt文件内容
# file_path = '/mnt/disk2/yangxiaoda/CGR/data/valid.txt'  # 替换成你的txt文件路径

# with open(file_path, 'r') as f:
#     lines = f.readlines()

# for line in lines:
#     if 'jpg:' in line:
#         split_index = line.index(':')
#         image_name = line[:split_index].strip()  # 分离出图片名部分
#         tensor_sequence = line[split_index + 1:].strip()  # 分离出tensor序列部分
#     elif '   ' in line:
#         str=line.strip()
#         tensor_sequence+=str
#         if 'cuda:' in line:
#             tensor_sequence = tensor_sequence.replace(", device='cuda:0')", "")
#             tensor_sequence = tensor_sequence.replace(",device='cuda:0')", "")
#             tensor_sequence = tensor_sequence.replace("tensor(", "")
#             print(image_name)
#             print(tensor_sequence)